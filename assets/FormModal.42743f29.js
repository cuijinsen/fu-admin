var v=Object.defineProperty,_=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var x=(e,t,u)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[t]=u,m=(e,t)=>{for(var u in t||(t={}))S.call(t,u)&&x(e,u,t[u]);if(B)for(var u of B(t))T.call(t,u)&&x(e,u,t[u]);return e},f=(e,t)=>_(e,A(t));var b=(e,t,u)=>new Promise((l,r)=>{var F=i=>{try{s(u.next(i))}catch(c){r(c)}},h=i=>{try{s(u.throw(i))}catch(c){r(c)}},s=i=>i.done?l(i.value):Promise.resolve(i.value).then(F,h);s((u=u.apply(e,t)).next())});import{a as M,B as q}from"./index.e55212df.js";import{B as R}from"./BasicForm.23326f3b.js";import{u as O}from"./useForm.5283242d.js";import{a as V,f as G,i as n,v as y,o as N,j,z as L,n as U,aB as W,G as z}from"./index.01016e1b.js";import{s as d}from"./index.55456fcf.js";import{a as $,v as H,b as J,e as K}from"./sysMenuApi.d7c463cd.js";const Q=e=>e==="dir",p=e=>e==="menu",w=e=>e==="button",C=e=>e==="0",ie=[{title:"\u83DC\u5355\u540D\u79F0",dataIndex:"menuName",width:120},{title:"\u83DC\u5355\u7C7B\u578B",dataIndex:"menuType",width:80},{title:"\u6392\u5E8F",dataIndex:"sort",width:80},{title:"\u72B6\u6001",dataIndex:"status",width:80},{title:"\u56FE\u6807",dataIndex:"icon",width:50},{title:"\u662F\u5426\u663E\u793A",dataIndex:"visible",width:80},{title:"\u662F\u5426\u7F13\u5B58",dataIndex:"keepalive",width:80},{title:"\u8DEF\u7531\u5730\u5740",dataIndex:"routePath",width:120},{title:"\u7EC4\u4EF6\u8DEF\u5F84",dataIndex:"component",width:200,align:"left"},{title:"\u6743\u9650\u6807\u8BC6",dataIndex:"permission",width:180,align:"left"},{title:"\u662F\u5426\u5916\u94FE",dataIndex:"linkExternal",width:80},{title:"\u662F\u5426\u5185\u5D4C",dataIndex:"frame",width:80},{title:"\u5916\u90E8\u94FE\u63A5",dataIndex:"linkUrl",width:120},{title:"\u5907\u6CE8",dataIndex:"remarks"}],le=[{field:"menuName",label:"\u83DC\u5355\u540D\u79F0",component:"Input",componentProps:{placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0"}}],X=[{field:"menuType",label:"\u83DC\u5355\u7C7B\u578B",component:"ApiRadioGroup",required:!0,componentProps:{api:d,params:{dictCode:"sys_menu_type"},isBtn:!0},defaultValue:"dir"},{field:"menuName",label:"\u83DC\u5355\u540D\u79F0",component:"Input",required:!0,componentProps:{placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",maxlength:100}},{field:"parentId",label:"\u4E0A\u7EA7\u83DC\u5355",component:"TreeSelect",componentProps:{placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u83DC\u5355",fieldNames:{label:"name",key:"id",value:"id"},getPopupContainer:()=>document.body}},{field:"sort",label:"\u6392\u5E8F",component:"InputNumber",required:!0,defaultValue:"1",componentProps:{placeholder:"\u8BF7\u8F93\u5165\u6392\u5E8F",min:1}},{field:"status",label:"\u72B6\u6001",component:"ApiRadioGroup",required:!0,componentProps:{api:d,params:{dictCode:"sys_status"}},defaultValue:"0"},{label:"\u5907\u6CE8",field:"remarks",component:"InputTextArea",componentProps:{placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",maxlength:500}},{field:"icon",label:"\u56FE\u6807",component:"IconPicker",ifShow:({values:e})=>!w(e.menuType)},{field:"visible",label:"\u662F\u5426\u663E\u793A",component:"ApiRadioGroup",required:!0,componentProps:{api:d,params:{dictCode:"sys_visible"}},defaultValue:"0",ifShow:({values:e})=>Q(e.menuType)||p(e.menuType)},{field:"routePath",label:"\u8DEF\u7531\u5730\u5740",component:"Input",required:!0,componentProps:{placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740"},ifShow:({values:e})=>!w(e.menuType)},{field:"component",label:"\u7EC4\u4EF6\u8DEF\u5F84",component:"Input",required:!0,componentProps:{placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},ifShow:({values:e})=>p(e.menuType)&&!C(e.linkExternal)},{field:"linkUrl",label:"\u5916\u90E8\u94FE\u63A5",component:"Input",required:!0,componentProps:{placeholder:"\u8BF7\u8F93\u5165\u5916\u90E8\u94FE\u63A5"},ifShow:({values:e})=>p(e.menuType)&&C(e.linkExternal)},{field:"keepalive",label:"\u662F\u5426\u7F13\u5B58",component:"ApiRadioGroup",required:!0,componentProps:{api:d,params:{dictCode:"sys_keepalive"}},defaultValue:"0",ifShow:({values:e})=>p(e.menuType)},{field:"permission",label:"\u6743\u9650\u6807\u8BC6",component:"Input",required:!0,componentProps:{placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u6807\u8BC6"},ifShow:({values:e})=>w(e.menuType)},{field:"linkExternal",label:"\u662F\u5426\u5916\u94FE",component:"ApiRadioGroup",required:!0,componentProps:{api:d,params:{dictCode:"sys_link_external"}},defaultValue:"1",ifShow:({values:e})=>p(e.menuType)},{field:"frame",label:"\u662F\u5426\u5185\u5D4C",component:"ApiRadioGroup",required:!0,componentProps:{api:d,params:{dictCode:"sys_frame"}},defaultValue:"0",ifShow:({values:e})=>p(e.menuType)&&C(e.linkExternal)}],Y=V({__name:"FormModal",emits:["success","register"],setup(e,{emit:t}){const u=G(()=>n(l)?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355"),l=y(!1),r=y(),{createMessage:F}=z(),[h,{setFieldsValue:s,updateSchema:i,resetFields:c,validate:D}]=O({labelWidth:100,schemas:X,showActionButtonGroup:!1,baseColProps:{lg:12,md:24},actionColOptions:{span:23}}),[k,{setModalProps:E,closeModal:P}]=M(o=>b(this,null,function*(){yield c(),E({confirmLoading:!1}),l.value=!!(o!=null&&o.isUpdate);const I=yield $({nodeId:o.record.id});if(yield i([{field:"parentId",componentProps:{treeData:I}}]),n(l)){r.value=o.record.id;const a=yield H({id:o.record.id});yield s(f(m({},a),{parentId:a.parentId==="0"?null:a.parentId,visible:a.visible?a.visible:"0",keepalive:a.keepalive?a.keepalive:"0",linkExternal:a.linkExternal?a.linkExternal:"1",frame:a.frame?a.frame:"0"}))}else yield s({parentId:o.record.parentId})}));function g(){return b(this,null,function*(){try{const o=yield D();E({confirmLoading:!0}),n(l)?yield K(f(m({},o),{id:r.value})):yield J(m({},o)),n(l)?F.success("\u7F16\u8F91\u6210\u529F\uFF01"):F.success("\u65B0\u589E\u6210\u529F\uFF01"),P(),t("success",{isUpdate:n(l),values:f(m({},o),{id:r.value})})}finally{E({confirmLoading:!1})}})}return(o,I)=>(N(),j(n(q),W(o.$attrs,{destroyOnClose:"",onRegister:n(k),title:n(u),onOk:g,width:"900px"}),{default:L(()=>[U(n(R),{onRegister:n(h)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});var re=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{re as F,Y as _,ie as c,le as s};
