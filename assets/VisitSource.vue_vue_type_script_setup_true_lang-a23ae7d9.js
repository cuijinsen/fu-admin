import{a as e,s as t,J as a,K as r,o as n,f as i,m as s,y as o,l as d,bp as l,h as m,r as u}from"./index-d32d699d.js";import{C as c}from"./index-d5b1635c.js";import"./index-80ea7d72.js";import"./index-cd646f4b.js";import{u as p}from"./useECharts-8dd670ef.js";import{a as f}from"./largeScreenApi-de23999b.js";const h=e({__name:"VisitSource",props:{loading:Boolean,width:{type:String,default:"100%"},height:{type:String,default:"300px"},startTime:{type:Object},endTime:{type:Object}},setup(e){const h=e,b=t(null),{setOptions:y}=p(b),g=t([]),v=t([]);function T(){return e=this,t=null,a=function*(){const e=yield f({deptId:u().getUserInfo.deptId,startTime:h.startTime?h.startTime.format("YYYY-MM-DD HH:mm:ss"):null,endTime:h.endTime?h.endTime.format("YYYY-MM-DD HH:mm:ss"):null});e.length>0?(g.value=e,v.value=e.map((e=>({value:e.count?e.count:0,name:"banner"===e.source?"banner":"cszm"===e.source?"出生证明":"need"===e.source?"我需要":"qrcode"===e.source?"二维码":"其他"})))):(g.value=[],v.value=[]),y({tooltip:{trigger:"item",formatter:"{b} : {c} ({d}%)"},legend:{bottom:"1%",left:"center"},series:[{color:["#5ab1ef","#b6a2de","#67e0e3","#2ec7c9"],name:"访问来源",type:"pie",radius:["40%","70%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},emphasis:{label:{show:!0,fontSize:"12",fontWeight:"bold"}},labelLine:{show:!0},data:v.value,animationType:"scale",animationEasing:"exponentialInOut",animationDelay:function(){return 100*Math.random()}}]})},new Promise(((r,n)=>{var i=e=>{try{o(a.next(e))}catch(t){n(t)}},s=e=>{try{o(a.throw(e))}catch(t){n(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,s);o((a=a.apply(e,t)).next())}));var e,t,a}return a((()=>{T()})),r((()=>h.startTime),(()=>{T()})),r((()=>h.endTime),(()=>{T()})),(t,a)=>(n(),i("div",null,[s(m(c),{title:"访问来源"},{default:o((()=>[d("div",{ref_key:"chartRef",ref:b,style:l({width:e.width,height:e.height})},null,4)])),_:1})]))}});export{h as _};
