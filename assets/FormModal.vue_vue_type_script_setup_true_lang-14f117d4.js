var e=Object.defineProperty,o=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(o,t,l)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[t]=l,i=(e,o)=>{for(var t in o||(o={}))a.call(o,t)&&s(e,t,o[t]);if(l)for(var t of l(o))n.call(o,t)&&s(e,t,o[t]);return e},d=(e,l)=>o(e,t(l)),p=(e,o,t)=>new Promise(((l,a)=>{var n=e=>{try{i(t.next(e))}catch(o){a(o)}},s=e=>{try{i(t.throw(e))}catch(o){a(o)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,s);i((t=t.apply(e,o)).next())}));import{b as r,B as c}from"./index-b361c612.js";import{k as m,B as u}from"./useForm-39f6e704.js";import{a as f,e as h,h as b,s as y,o as P,i as x,y as I,m as g,aG as w,E as v}from"./index-d32d699d.js";import{s as A}from"./sysPostApi-f832c107.js";import{d as j}from"./sysRoleApi-b6b41faf.js";import{s as k}from"./sysDeptApi-2c1e26d4.js";import{s as O,g as F}from"./index-2e5c6a76.js";import{v as N,b as _,c as R}from"./sysUserApi-9664c2ba.js";const S=[{title:"账号",dataIndex:"sysAccount",width:120},{title:"部门",dataIndex:"deptName",width:120},{title:"昵称",dataIndex:"nickname",width:120},{title:"性别",dataIndex:"sex",width:120},{title:"姓名",dataIndex:"realname",width:120},{title:"英文名",dataIndex:"englishName",width:120},{title:"邮箱",dataIndex:"email",width:120},{title:"手机号",dataIndex:"phone",width:120},{title:"工号",dataIndex:"staffNumber",width:120},{title:"生日",dataIndex:"birthday",width:120},{title:"锁定",dataIndex:"lockFlag",width:120},{title:"排序",dataIndex:"sort",width:80},{title:"状态",dataIndex:"sysStatus",width:80},{title:"备注",dataIndex:"remarks"}],q=[{field:"sysAccount",label:"账号",component:"Input",componentProps:{placeholder:"请输入账号"}},{field:"nickname",label:"昵称",component:"Input",componentProps:{placeholder:"请输入昵称"}},{field:"realname",label:"姓名",component:"Input",componentProps:{placeholder:"请输入姓名"}},{field:"englishName",label:"英文名",component:"Input",componentProps:{placeholder:"请输入英文名"}},{field:"phone",label:"手机号",component:"Input",componentProps:{placeholder:"请输入手机号"}},{field:"staffNumber",label:"工号",component:"Input",componentProps:{placeholder:"请输入工号"}}],M=[{field:"sysAccount",label:"账号",component:"Input",required:!0,componentProps:{placeholder:"请输入账号",maxlength:100}},{field:"deptId",label:"部门",component:"ApiTreeSelect",componentProps:({formModel:e})=>({placeholder:"请选择部门",api:k,fieldNames:{label:"name",key:"id",value:"id"}})},{field:"sysPassword",label:"密码",component:"InputPassword",required:!0,componentProps:{placeholder:"请输入密码",maxlength:100}},{field:"nickname",label:"昵称",component:"Input",required:!0,componentProps:{placeholder:"请输入昵称",maxlength:100}},{field:"sex",label:"性别",component:"ApiRadioGroup",required:!0,componentProps:{api:O,params:{dictCode:"sys_sex"}},defaultValue:"1"},{field:"realname",label:"姓名",component:"Input",componentProps:{placeholder:"请输入姓名",maxlength:100}},{field:"englishName",label:"英文名",component:"Input",componentProps:{placeholder:"请输入英文名",maxlength:100}},{field:"email",label:"邮箱",component:"Input",componentProps:{placeholder:"请输入邮箱",maxlength:100}},{field:"phone",label:"手机号",component:"Input",componentProps:{placeholder:"请输入手机号",maxlength:30}},{field:"staffNumber",label:"工号",component:"Input",componentProps:{placeholder:"请输入工号",maxlength:30}},{field:"birthday",label:"生日",component:"DatePicker",componentProps:{placeholder:"请选择生日",valueFormat:"YYYY-MM-DD"}},{field:"lockFlag",label:"锁定",component:"ApiRadioGroup",required:!0,componentProps:{api:O,params:{dictCode:"sys_lock_flag"}},defaultValue:"0"},{field:"postIds",label:"岗位",component:"ApiSelect",componentProps:()=>({placeholder:"请选择岗位",api:A,mode:"multiple",labelField:"postName",valueField:"id"})},{field:"roleIds",label:"角色",component:"ApiSelect",componentProps:()=>({placeholder:"请选择角色",api:j,mode:"multiple",labelField:"roleName",valueField:"id"})},{field:"sort",label:"排序",component:"InputNumber",required:!0,defaultValue:"1",componentProps:{placeholder:"请输入排序",min:1}},{field:"sysStatus",label:"状态",component:"ApiRadioGroup",required:!0,componentProps:{api:O,params:{dictCode:"sys_status"}},defaultValue:"0"},{label:"备注",field:"remarks",component:"InputTextArea",componentProps:{placeholder:"请输入备注",maxlength:500}}],C=f({__name:"FormModal",emits:["success","register"],setup(e,{emit:o}){const t=h((()=>b(l)?"编辑用户":"新增用户")),l=y(!1),a=y(),{createMessage:n}=v(),[s,{setFieldsValue:f,resetFields:A,validate:j,updateSchema:k}]=m({labelWidth:100,schemas:M,showActionButtonGroup:!1,actionColOptions:{span:23},baseColProps:{lg:12,md:24}}),[O,{setModalProps:S,closeModal:q}]=r((e=>p(this,null,(function*(){if(yield A(),S({confirmLoading:!1}),l.value=!!(null==e?void 0:e.isUpdate),yield k([{field:"sysPassword",ifShow:!b(l)}]),b(l)){a.value=e.record.id;const o=yield N({id:e.record.id});yield f(i({},o))}else{const e=yield F({key:"sys_init_password"});yield f({sysPassword:e})}}))));function C(){return p(this,null,(function*(){try{const e=yield j();S({confirmLoading:!0}),b(l)?yield R(d(i({},e),{id:a.value})):yield _(i({},e)),b(l)?n.success("编辑成功！"):n.success("新增成功！"),q(),o("success",{isUpdate:b(l),values:d(i({},e),{id:a.value})})}finally{S({confirmLoading:!1})}}))}return(e,o)=>(P(),x(b(c),w({title:t.value,destroyOnClose:""},e.$attrs,{width:"900px",onOk:C,onRegister:b(O)}),{default:I((()=>[g(b(u),{onRegister:b(s)},null,8,["onRegister"])])),_:1},16,["title","onRegister"]))}});export{C as _,S as c,q as s};
