var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,s,o)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o,i=(e,t,s)=>new Promise(((o,r)=>{var n=e=>{try{i(s.next(e))}catch(t){r(t)}},a=e=>{try{i(s.throw(e))}catch(t){r(t)}},i=e=>e.done?o(e.value):Promise.resolve(e.value).then(n,a);i((s=s.apply(e,t)).next())}));import{a as l,s as c,bs as d,K as p,at as u,aF as y,bT as f,o as m,f as b,m as g,y as h,w as v,i as _,z as j,F as I,h as T,t as k,f6 as D,j as O,E as w}from"./index-d32d699d.js";import{T as x}from"./index-280a19eb.js";import{u as S,B as C}from"./useTable-ba3fb261.js";import{T as P}from"./useForm-39f6e704.js";import{u as F}from"./index-b361c612.js";import{c as E,s as R,_ as A}from"./FormModal.vue_vue_type_script_setup_true_lang-ccb20b23.js";import{f as B,r as M}from"./sysDeptApi-2c1e26d4.js";import{s as U}from"./index-2e5c6a76.js";import{a as K}from"./sysAreaApi-e41d1f2f.js";const z=l({__name:"index",props:{nodeId:{type:String}},emits:["refresh-tree"],setup(e,{expose:l,emit:z}){const W=e,q=c([]),G=c([]);d((()=>i(this,null,(function*(){q.value=yield U({dictCode:"sys_status"}),G.value=yield U({dictCode:"sys_org_type"})}))));const{createMessage:H}=w(),[J,{openModal:L}]=F(),[N,{reload:Q}]=S({title:"部门列表",api:B,rowKey:"id",columns:E,formConfig:{baseColProps:{sm:24,lg:6},labelWidth:90,schemas:R,autoSubmitOnEnter:!0,resetButtonOptions:{preIcon:"ant-design:delete-outlined"},submitButtonOptions:{preIcon:"ant-design:search-outlined"}},showIndexColumn:!1,useSearchForm:!0,showTableSetting:!0,bordered:!0,actionColumn:{auth:["system:sysDept:updateSysDept","system:sysDept:removeSysDept"],width:80,title:"操作",dataIndex:"action"},beforeFetch:function(e){return i=((e,t)=>{for(var s in t||(t={}))r.call(t,s)&&a(e,s,t[s]);if(o)for(var s of o(t))n.call(t,s)&&a(e,s,t[s]);return e})({},e),l={parentId:W.nodeId?W.nodeId:"0"},t(i,s(l));var i,l},afterFetch:e=>{e.forEach((e=>i(this,null,(function*(){null===e.city&&""===e.city&&void 0===e.city||(e.city=yield K({code:e.city})),null===e.district&&""===e.district&&void 0===e.district||(e.district=yield K({code:e.district}))}))))}});function V(){const e={parentId:W.nodeId};L(!0,{record:e,isUpdate:!1})}function X(e){L(!0,{record:e,isUpdate:!0})}function Y(e){return i(this,null,(function*(){yield M({ids:e.id}),H.success("删除成功！"),z("refresh-tree","0"===e.parentId?void 0:e.parentId)}))}function Z({isUpdate:e,values:t}){z("refresh-tree",t.parentId)}return p((()=>W.nodeId),(()=>{u((()=>{Q()}))})),l({refresh:function(){Q()}}),(e,t)=>{const s=y("a-button"),o=f("auth");return m(),b("div",null,[g(T(C),{onRegister:T(N)},{toolbar:h((()=>[v((m(),_(s,{preIcon:"ant-design:plus-outlined",type:"primary",onClick:V},{default:h((()=>[j("新增 ")])),_:1})),[[o,["system:sysDept:addSysDept"]]])])),bodyCell:h((({column:e,record:t})=>["orgType"===e.key?(m(),b(I,{key:0},["1"===t.orgType?(m(),_(T(x),{key:0,color:"processing"},{default:h((()=>[j(k(T(D)(G.value,t.orgType)),1)])),_:2},1024)):O("",!0),"2"===t.orgType?(m(),_(T(x),{key:1,color:"processing"},{default:h((()=>[j(k(T(D)(G.value,t.orgType)),1)])),_:2},1024)):O("",!0),"3"===t.orgType?(m(),_(T(x),{key:2,color:"processing"},{default:h((()=>[j(k(T(D)(G.value,t.orgType)),1)])),_:2},1024)):O("",!0),"4"===t.orgType?(m(),_(T(x),{key:3,color:"processing"},{default:h((()=>[j(k(T(D)(G.value,t.orgType)),1)])),_:2},1024)):O("",!0)],64)):O("",!0),"status"===e.key?(m(),_(T(x),{key:1,color:"0"===t.status?"processing":"error"},{default:h((()=>[j(k(T(D)(q.value,t.status)),1)])),_:2},1032,["color"])):O("",!0),"action"===e.key?(m(),_(T(P),{key:2,actions:[{auth:["system:sysDept:updateSysDept"],icon:"clarity:note-edit-line",tooltip:"编辑",onClick:X.bind(null,t)},{auth:["system:sysDept:removeSysDept"],icon:"ant-design:delete-outlined",tooltip:"删除",color:"error",popConfirm:{title:"是否确认删除",confirm:Y.bind(null,t)}}]},null,8,["actions"])):O("",!0)])),_:1},8,["onRegister"]),g(A,{onRegister:T(J),onSuccess:Z},null,8,["onRegister"])])}}});export{z as _};
