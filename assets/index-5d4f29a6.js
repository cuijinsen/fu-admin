var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,r=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&c(e,n,t[n]);if(l)for(var n of l(t))s.call(t,n)&&c(e,n,t[n]);return e},o=(e,l)=>t(e,n(l));import{eL as i,eM as d,eN as u,eO as y,eP as h,eQ as p,d7 as f,dd as v,eR as k,eS as g,eT as m,eU as b,a as K,s as x,eV as S,q as L,e as E,bw as A,K as C,o as _,f as T,h as N,aJ as O,j as w,i as B,y as j,z as I,t as $,dz as D,p as P,m as U,eW as R,ba as M,F as H,aI as X,ci as Y,aK as F,aL as V,eX as z,b9 as J,bo as q,d3 as G,eY as W,bV as Q,G as Z,eZ as ee,J as te,at as ne,c2 as le,cO as ae,e_ as se,e$ as ce,aC as re,v as oe,D as ie,dr as de,aw as ue,aE as ye,f0 as he,ds as pe,X as fe,f1 as ve,eg as ke,b4 as ge,w as me,x as be,bH as Ke,aG as xe,ex as Se,f2 as Le,bt as Ee,dA as Ae}from"./index-d32d699d.js";import{f as Ce}from"./fromPairs-c5e23fef.js";import{T as _e}from"./index-64da741e.js";import{D as Te}from"./index-b4d18824.js";import{g as Ne}from"./get-8e454bdf.js";const Oe=f((function(e,t){return v(e)?function(e,t,n,l){var a=-1,s=y,c=!0,r=e.length,o=[],f=t.length;if(!r)return o;n&&(t=i(t,d(n))),l?(s=h,c=!1):t.length>=200&&(s=p,c=!1,t=new u(t));e:for(;++a<r;){var v=e[a],k=null==n?v:n(v);if(v=l||0!==v?v:0,c&&k==k){for(var g=f;g--;)if(t[g]===k)continue e;o.push(v)}else s(t,k,l)||o.push(v)}return o}(e,k(t,1,v,!0)):[]}));function we(e,t){return t?"string"==typeof t?` ${e}--${t}`:Array.isArray(t)?t.reduce(((t,n)=>t+we(e,n)),""):Object.keys(t).reduce(((n,l)=>n+(t[l]?we(e,l):"")),""):""}function Be(e){return(t,n)=>(t&&"string"!=typeof t&&(n=t,t=""),`${t=t?`${e}__${t}`:e}${we(t,n)}`)}function je(e){return[Be(`${g}-${e}`)]}const Ie=Symbol(),$e=Symbol();function De(e,t){if(!m(e)||e[$e])return e;const{values:n,required:l,default:a,type:s,validator:c}=e,r=n||c?e=>{let l=!1,s=[];if(n&&(s=[...n,a],l||(l=s.includes(e))),c&&(l||(l=c(e))),!l&&s.length>0){const n=[...new Set(s)].map((e=>JSON.stringify(e))).join(", ");b(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${n}], got value ${JSON.stringify(e)}.`)}return l}:void 0;return{type:"object"==typeof s&&Object.getOwnPropertySymbols(s).includes(Ie)?s[Ie]:s,required:!!l,default:a,validator:r,[$e]:!0}}var Pe=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(Pe||{});const Ue=(Re={value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}},Ce(Object.entries(Re).map((([e,t])=>[e,De(t,e)]))));var Re;const Me={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},He=K({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const n=e,l=x(""),[a]=je("tree-header"),s=S(),{t:c}=L(),r=E((()=>["mr-1","w-full",{"ml-5":s.headerTitle||n.title}])),o=E((()=>{const{checkable:e}=n,t=[{label:c("component.tree.expandAll"),value:Pe.EXPAND_ALL},{label:c("component.tree.unExpandAll"),value:Pe.UN_EXPAND_ALL,divider:e}];return e?[{label:c("component.tree.selectAll"),value:Pe.SELECT_ALL},{label:c("component.tree.unSelectAll"),value:Pe.UN_SELECT_ALL,divider:e},...t,{label:c("component.tree.checkStrictly"),value:Pe.CHECK_STRICTLY},{label:c("component.tree.checkUnStrictly"),value:Pe.CHECK_UN_STRICTLY}]:t}));function i(e){var l,a,s,c;const{key:r}=e;switch(r){case Pe.SELECT_ALL:null==(l=n.checkAll)||l.call(n,!0);break;case Pe.UN_SELECT_ALL:null==(a=n.checkAll)||a.call(n,!1);break;case Pe.EXPAND_ALL:null==(s=n.expandAll)||s.call(n,!0);break;case Pe.UN_EXPAND_ALL:null==(c=n.expandAll)||c.call(n,!1);break;case Pe.CHECK_STRICTLY:t("strictly-change",!1);break;case Pe.CHECK_UN_STRICTLY:t("strictly-change",!0)}}const d=A((function(e){t("search",e)}),200);return C((()=>l.value),(e=>{d(e)})),C((()=>n.searchText),(e=>{e!==l.value&&(l.value=e)})),(e,t)=>(_(),T("div",{class:P([N(a)(),"flex px-2 py-1.5 items-center"])},[N(s).headerTitle?O(e.$slots,"headerTitle",{key:0}):w("",!0),!N(s).headerTitle&&e.title?(_(),B(N(D),{key:1,helpMessage:e.helpMessage},{default:j((()=>[I($(e.title),1)])),_:1},8,["helpMessage"])):w("",!0),e.search||e.toolbar?(_(),T("div",Me,[e.search?(_(),T("div",{key:0,class:P(r.value)},[U(N(R),{placeholder:N(c)("common.searchText"),size:"small",allowClear:"",value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e)},null,8,["placeholder","value"])],2)):w("",!0),e.toolbar?(_(),B(N(G),{key:1,onClick:t[1]||(t[1]=q((()=>{}),["prevent"]))},{overlay:j((()=>[U(N(M),{onClick:i},{default:j((()=>[(_(!0),T(H,null,X(o.value,(e=>(_(),T(H,{key:e.value},[U(N(Y),F(V({key:e.value})),{default:j((()=>[I($(e.label),1)])),_:2},1040),e.divider?(_(),B(N(z),{key:0})):w("",!0)],64)))),128))])),_:1})])),default:j((()=>[U(N(J),{icon:"ion:ellipsis-vertical"})])),_:1})):w("",!0)])):w("",!0)],2))}}),Xe=({icon:e})=>e?W(e)?Q(J,{icon:e,class:"mr-1"}):J:null;const Ye="context-menu",Fe={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}},Ve=e=>{const{item:t}=e;return U("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&U(J,{class:"mr-2",icon:t.icon},null),U("span",null,[t.label])])},ze=K({name:"ContextMenu",props:Fe,setup(e){const t=x(null),n=x(!1),l=E((()=>{const{axis:t,items:n,styles:l,width:a}=e,{x:s,y:c}=t||{x:0,y:0},i=40*(n||[]).length,d=a,u=document.body,y=u.clientWidth<s+d?s-d:s,h=u.clientHeight<c+i?c-i:c;return o(r({},l),{position:"absolute",width:`${a}px`,left:`${y+1}px`,top:`${h+1}px`,zIndex:9999})}));function a(e,t){const{handler:l,disabled:a}=e;a||(n.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==l||l())}function s(t){return t.filter((e=>!e.hidden)).map((t=>{const{disabled:l,label:c,children:r,divider:o=!1}=t,i={item:t,handler:a,showIcon:e.showIcon};return r&&0!==r.length?N(n)?U(M.SubMenu,{key:c,disabled:l,popupClassName:`${Ye}__popup`},{title:()=>U(Ve,i,null),default:()=>s(r)}):null:U(H,null,[U(M.Item,{disabled:l,class:`${Ye}__item`,key:c},{default:()=>[U(Ve,i,null)]}),o?U(Te,{key:`d-${c}`},null):null])}))}return te((()=>{ne((()=>n.value=!0))})),le((()=>{const e=N(t);e&&document.body.removeChild(e)})),()=>{let a;if(!N(n))return null;const{items:c}=e;return U("div",{class:Ye},[U(M,{inlineIndent:12,mode:"vertical",ref:t,style:N(l)},(r=a=s(c),"function"==typeof r||"[object Object]"===Object.prototype.toString.call(r)&&!ae(r)?a:{default:()=>[a]}))]);var r}}}),Je={domList:[],resolve:()=>{}},qe=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),se)return new Promise((n=>{const l=document.body,a=document.createElement("div"),s={};e.styles&&(s.styles=e.styles),e.items&&(s.items=e.items),e.event&&(s.customEvent=t,s.axis={x:t.clientX,y:t.clientY});const c=U(ze,s);ce(c,a);const r=function(){Je.resolve("")};Je.domList.push(a);const o=function(){Je.domList.forEach((e=>{try{e&&l.removeChild(e)}catch(t){}})),l.removeEventListener("click",r),l.removeEventListener("scroll",r)};Je.resolve=function(e){o(),n(e)},o(),l.appendChild(a),l.addEventListener("click",r),l.addEventListener("scroll",r)}))},Ge=function(){Je&&(Je.resolve(""),Je.domList=[])};const We=K({name:"BasicTree",inheritAttrs:!1,props:Ue,emits:["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],setup(e,{attrs:t,slots:n,emit:l,expose:a}){const[s]=je("tree"),c=oe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),i=oe({startSearch:!1,searchText:"",searchData:[]}),d=x([]),[u]=function(e=!0){return re()&&e&&le((()=>{Ge()})),[qe,Ge]}(),y=E((()=>{const{fieldNames:t}=e;return r({children:"children",title:"title",key:"key"},t)})),h=E((()=>{let n=o(r(r({blockNode:!0},t),e),{expandedKeys:c.expandedKeys,selectedKeys:c.selectedKeys,checkedKeys:c.checkedKeys,checkStrictly:c.checkStrictly,fieldNames:N(y),"onUpdate:expandedKeys":e=>{c.expandedKeys=e,l("update:expandedKeys",e)},"onUpdate:selectedKeys":e=>{c.selectedKeys=e,l("update:selectedKeys",e)},onCheck:(e,t)=>{let n=ie(c.checkedKeys);if(de(n)&&i.startSearch){const{key:e}=N(y);n=Oe(n,S(t.node.$attrs.node[e])),t.checked&&n.push(t.node.$attrs.node[e]),c.checkedKeys=n}else c.checkedKeys=e;const a=ie(c.checkedKeys);l("update:value",a),l("check",a,t)},onRightClick:_});return ue(n,"treeData","class")})),p=E((()=>i.startSearch?i.searchData:N(d))),f=E((()=>!p.value||0===p.value.length)),{deleteNodeByKey:v,insertNodeByKey:k,insertNodesByKey:g,filterByLevel:m,updateNodeByKey:b,getAllKeys:K,getChildrenKeys:S,getEnabledKeys:L,getSelectedNode:A}=function(e,t){function n(l){const a=[],s=l||N(e),{key:c,children:r}=N(t);if(!r||!c)return a;for(let e=0;e<s.length;e++){const t=s[e];a.push(t[c]);const l=t[r];l&&l.length&&a.push(...n(l))}return a}return{deleteNodeByKey:function n(l,a){if(!l)return;const s=a||N(e),{key:c,children:r}=N(t);if(r&&c)for(let e=0;e<s.length;e++){const t=s[e],a=t[r];if(t[c]===l){s.splice(e,1);break}a&&a.length&&n(l,t[r])}},insertNodeByKey:function({parentKey:n=null,node:l,push:a="push"}){const s=Z(N(e));if(!n)return s[a](l),void(e.value=s);const{key:c,children:r}=N(t);r&&c&&(ee(s,(e=>{if(e[c]===n)return e[r]=e[r]||[],e[r][a](l),!0})),e.value=s)},insertNodesByKey:function({parentKey:n=null,list:l,push:a="push"}){const s=Z(N(e));if(l&&!(l.length<1))if(n){const{key:c,children:r}=N(t);if(!r||!c)return;ee(s,(t=>{if(t[c]===n){t[r]=t[r]||[];for(let e=0;e<l.length;e++)t[r][a](l[e]);return e.value=s,!0}}))}else for(let e=0;e<l.length;e++)s[a](l[e])},filterByLevel:function n(l=1,a,s=1){if(!l)return[];const c=[],r=a||N(e)||[];for(let e=0;e<r.length;e++){const a=r[e],{key:o,children:i}=N(t),d=o?a[o]:"",u=i?a[i]:[];c.push(d),u&&u.length&&s<l&&(s+=1,c.push(...n(l,u,s)))}return c},updateNodeByKey:function n(l,a,s){if(!l)return;const c=s||N(e),{key:o,children:i}=N(t);if(i&&o)for(let e=0;e<c.length;e++){const t=c[e],s=t[i];if(t[o]===l){c[e]=r(r({},c[e]),a);break}s&&s.length&&n(l,a,t[i])}},getAllKeys:n,getChildrenKeys:function l(a,s){const c=[],r=s||N(e),{key:o,children:i}=N(t);if(!i||!o)return c;for(let e=0;e<r.length;e++){const t=r[e],s=t[i];a===t[o]?(c.push(t[o]),s&&s.length&&c.push(...n(s))):s&&s.length&&c.push(...l(a,s))}return c},getEnabledKeys:function n(l){const a=[],s=l||N(e),{key:c,children:r}=N(t);if(!r||!c)return a;for(let e=0;e<s.length;e++){const t=s[e];!0!==t.disabled&&!1!==t.selectable&&a.push(t[c]);const l=t[r];l&&l.length&&a.push(...n(l))}return a},getSelectedNode:function t(n,l,a){return n||0===n?((l||N(e)).forEach((e=>{if((null==a?void 0:a.key)||0===(null==a?void 0:a.key))return a;e.key!==n?e.children&&e.children.length&&(a=t(n,e.children,a)):a=e})),a||null):null}}}(d,y);function _(t){return n=this,l=arguments,a=function*({event:t,node:n}){var l;const{rightMenuList:a=[],beforeRightClick:s}=e;let c={event:t,items:[]};if(s&&ye(s)){let e=yield s(n,t);Array.isArray(e)?c.items=e:Object.assign(c,e)}else c.items=a;(null==(l=c.items)?void 0:l.length)&&(c.items=c.items.filter((e=>!e.hidden)),u(c))},new Promise(((e,t)=>{var s=e=>{try{r(a.next(e))}catch(n){t(n)}},c=e=>{try{r(a.throw(e))}catch(n){t(n)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,c);r((a=a.apply(n,l)).next())}));var n,l,a}function T(e){c.expandedKeys=e}function O(e){c.selectedKeys=e}function w(e){c.checkedKeys=e}function B(e){c.checkedKeys=e?L():[]}function j(e){c.expandedKeys=e?K():[]}function I(e){c.checkStrictly=e}function $(t){if(t!==i.searchText&&(i.searchText=t),l("update:searchValue",t),!t)return void(i.startSearch=!1);const{filterFn:n,checkable:a,expandOnSearch:s,checkOnSearch:c,selectedOnSearch:r}=N(e);i.startSearch=!0;const{title:o,key:u}=N(y),h=[];if(i.searchData=he(N(d),(e=>{var l,a;const s=n?n(t,e,N(y)):null!=(a=null==(l=e[o])?void 0:l.includes(t))&&a;return s&&h.push(e[u]),s}),N(y)),s){const e=pe(i.searchData).map((e=>e[u]));e&&e.length&&T(e)}c&&a&&h.length&&w(h),r&&h.length&&O(h)}function D(t,n){if(e.clickRowToExpand&&n&&0!==n.length)if(c.expandedKeys.includes(t)){const e=[...c.expandedKeys],n=e.findIndex((e=>e===t));-1!==n&&e.splice(n,1),T(e)}else T([...c.expandedKeys,t])}C((()=>e.searchValue),(e=>{e!==i.searchText&&(i.searchText=e)}),{immediate:!0}),C((()=>e.treeData),(e=>{e&&$(i.searchText)})),fe((()=>{d.value=e.treeData})),te((()=>{const t=parseInt(e.defaultExpandLevel);t>0?c.expandedKeys=m(t):e.defaultExpandAll&&j(!0)})),fe((()=>{c.expandedKeys=e.expandedKeys})),fe((()=>{c.selectedKeys=e.selectedKeys})),fe((()=>{c.checkedKeys=e.checkedKeys})),C((()=>e.value),(()=>{c.checkedKeys=ie(e.value||[])}),{immediate:!0}),C((()=>c.checkedKeys),(()=>{const e=ie(c.checkedKeys);l("update:value",e),l("change",e)})),fe((()=>{c.checkStrictly=e.checkStrictly}));const P={setExpandedKeys:T,getExpandedKeys:function(){return c.expandedKeys},setSelectedKeys:O,getSelectedKeys:function(){return c.selectedKeys},setCheckedKeys:w,getCheckedKeys:function(){return c.checkedKeys},insertNodeByKey:k,insertNodesByKey:g,deleteNodeByKey:v,updateNodeByKey:b,getSelectedNode:A,checkAll:B,expandAll:j,filterByLevel:e=>{c.expandedKeys=m(e)},setSearchValue:e=>{$(e)},getSearchValue:()=>i.searchText};function R(t){const{actionList:n}=e;if(n&&0!==n.length)return n.map(((e,n)=>{var l;let a=!0;return ye(e.show)?a=null==(l=e.show)?void 0:l.call(e,t):Ee(e.show)&&(a=e.show),a?U("span",{key:n,class:s("action")},[e.render(t)]):null}))}const M=E((()=>{const t=Z(p.value);return ve(t,((t,l)=>{var a;const c=i.searchText,{highlight:r}=N(e),{title:o,key:d,children:u}=N(y),p=function(t,n){return!n&&e.renderIcon&&ye(e.renderIcon)?e.renderIcon(t):n}(t,t.icon),f=Ne(t,o),v=c?f.indexOf(c):-1,k=i.startSearch&&!Le(c)&&r&&-1!==v,g=`color: ${Ee(r)?"#f50":r}`,m=k?U("span",{class:(null==(a=N(h))?void 0:a.blockNode)?`${s("content")}`:""},[U("span",null,[f.substr(0,v)]),U("span",{style:g},[c]),U("span",null,[f.substr(v+c.length)])]):f;return t[o]=U("span",{class:`${s("title")} pl-2`,onClick:D.bind(null,t[d],t[u])},[(null==n?void 0:n.title)?Ae(n,"title",t):U(H,null,[p&&U(Xe,{icon:p},null),m,U("span",{class:s("actions")},[R(t)])])]),t})),t}));return a(P),()=>{let l;const{title:a,helpMessage:c,toolbar:r,search:o,checkable:d}=e,u=a||r||o||n.headerTitle,y={height:"calc(100% - 38px)"};return U("div",{class:[s(),"h-full",t.class]},[u&&U(He,{checkable:d,checkAll:B,expandAll:j,title:a,search:o,toolbar:r,helpMessage:c,onStrictlyChange:I,onSearch:$,searchText:i.searchText},(p=l=ke(n),"function"==typeof p||"[object Object]"===Object.prototype.toString.call(p)&&!ae(p)?l:{default:()=>[l]})),U(ge,{spinning:N(e.loading),tip:"加载中..."},{default:()=>[me(U(Ke,{style:y},{default:()=>[U(_e,xe(N(h),{showIcon:!1,treeData:M.value}),null)]}),[[be,!N(f)]]),me(U(Se,{image:Se.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[be,N(f)]])]})]);var p}}});export{We as _};
