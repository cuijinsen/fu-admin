var e=Object.defineProperty,o=Object.defineProperties,r=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(o,r,s)=>r in o?e(o,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[r]=s,i=(e,o,r)=>new Promise(((s,t)=>{var a=e=>{try{i(r.next(e))}catch(o){t(o)}},n=e=>{try{i(r.throw(e))}catch(o){t(o)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(a,n);i((r=r.apply(e,o)).next())}));import{b as l,B as c}from"./index-b361c612.js";import{k as d,B as p}from"./useForm-39f6e704.js";import{a as m,e as u,s as f,o as y,i as P,y as b,m as g,h as v,aG as w,r as h,E as O}from"./index-d32d699d.js";import{r as j}from"./sysUserApi-9664c2ba.js";const I=m({__name:"FormModalUpdatePwd",emits:["success","register"],setup(e,{emit:m}){const I=u((()=>"修改密码")),x=f(),{createMessage:R,createConfirm:C}=O(),[M,{resetFields:_,validate:k}]=d({labelWidth:100,schemas:[{field:"oldPassword",label:"原密码",component:"InputPassword",required:!0,componentProps:{placeholder:"请输入原密码"},colProps:{lg:24,md:24}},{field:"sysPassword",label:"新密码",component:"InputPassword",required:!0,componentProps:{placeholder:"请输入新密码"}},{field:"confirmSysPassword",label:"确认密码",component:"InputPassword",required:!0,dynamicRules:({values:e})=>[{validator:(o,r)=>r&&e.sysPassword!==r?Promise.reject(new Error("两次输入的密码不一致!")):Promise.resolve()}],componentProps:{placeholder:"请再次输入新密码"}}],showActionButtonGroup:!1,actionColOptions:{span:23},baseColProps:{lg:12,md:24}}),[q,{setModalProps:B,closeModal:E}]=l((()=>{_(),B({confirmLoading:!1}),x.value=h().getUserInfo.userId}));function F(){return i(this,null,(function*(){try{const e=yield k();C({iconType:"warning",title:"提示",content:"确认修改密码？",onOk:()=>i(this,null,(function*(){var i,l;B({confirmLoading:!0}),yield j((i=((e,o)=>{for(var r in o||(o={}))t.call(o,r)&&n(e,r,o[r]);if(s)for(var r of s(o))a.call(o,r)&&n(e,r,o[r]);return e})({},e),l={id:x.value},o(i,r(l)))),R.success("修改成功！"),E(),m("success",x.value)}))})}finally{B({confirmLoading:!1})}}))}return(e,o)=>(y(),P(v(c),w({minHeight:0,title:I.value,destroyOnClose:""},e.$attrs,{onOk:F,onRegister:v(q)}),{default:b((()=>[g(v(p),{onRegister:v(M)},null,8,["onRegister"])])),_:1},16,["title","onRegister"]))}});export{I as _};
