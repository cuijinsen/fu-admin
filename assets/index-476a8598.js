import{v as t,aB as e,X as n,e as a,ax as s,at as u,D as o,h as r,aC as l,s as i,aD as c,a as d,B as v,q as f,aE as p,L as m,aF as y,o as C,i as S,y as b,z as g,t as x,aG as h,b as B,aH as w,aI as z,aJ as F,aK as A,aL as I,m as N,N as T}from"./index-d32d699d.js";function $(i,c="value",d="change",v){const f=l(),p=null==f?void 0:f.emit,m=t({value:i[c]}),y=e(m);n((()=>{m.value=i[c]}));return[a({get:()=>m.value,set(t){s(t,y.value)||(m.value=t,u((()=>{null==p||p(d,t,...o(r(v))||[])})))}}),t=>{m.value=t},y]}const j=m(d({name:"CountButton",components:{Button:v},props:{value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(t){const e=i(!1),{currentCount:s,isStart:u,start:o,reset:l}=function(t){const e=i(t),n=i(!1);let a;function s(){a&&window.clearInterval(a)}function u(){n.value=!1,s(),a=null}function o(){r(n)||a||(n.value=!0,a=setInterval((()=>{1===r(e)?(u(),e.value=t):e.value-=1}),1e3))}function l(){e.value=t,u()}return c((()=>{l()})),{start:o,reset:l,restart:function(){l(),o()},clear:s,stop:u,currentCount:e,isStart:n}}(t.count),{t:d}=f(),v=a((()=>r(u)?d("component.countdown.sendText",[r(s)]):d("component.countdown.normalText")));return n((()=>{void 0===t.value&&l()})),{handleStart:function(){return n=this,a=null,s=function*(){const{beforeStartFunc:n}=t;if(n&&p(n)){e.value=!0;try{(yield n())&&o()}finally{e.value=!1}}else o()},new Promise(((t,e)=>{var u=t=>{try{r(s.next(t))}catch(n){e(n)}},o=t=>{try{r(s.throw(t))}catch(n){e(n)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(u,o);r((s=s.apply(n,a)).next())}));var n,a,s},currentCount:s,loading:e,getButtonText:v,isStart:u}}}),[["render",function(t,e,n,a,s,u){const o=y("Button");return C(),S(o,h(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:b((()=>[g(x(t.getButtonText),1)])),_:1},16,["disabled","onClick","loading"])}]]);const k=T(m(d({name:"CountDownInput",components:{CountButton:j},inheritAttrs:!1,props:{value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},setup(t){const{prefixCls:e}=B("countdown-input"),[n]=$(t);return{prefixCls:e,state:n}}}),[["render",function(t,e,n,a,s,u){const o=y("CountButton"),r=y("a-input");return C(),S(r,h(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),w({addonAfter:b((()=>[N(o,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])])),_:2},[z(Object.keys(t.$slots).filter((t=>"addonAfter"!==t)),(e=>({name:e,fn:b((n=>[F(t.$slots,e,A(I(n||{})))]))})))]),1040,["class","size","value"])}]]));T(j);export{k as C,$ as u};
