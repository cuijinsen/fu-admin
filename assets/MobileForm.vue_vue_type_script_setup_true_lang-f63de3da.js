import{a as e,b as s,r as a,s as l,v as o,e as t,o as n,f as i,m as r,y as c,h as m,I as u,B as d,z as g,t as p,F as f,j as y,q as v,D as x,E as _}from"./index-d32d699d.js";import{F as b}from"./index-06c8a48f.js";import"./index-cd646f4b.js";import{C as h}from"./index-476a8598.js";import{u as k,a as C,_ as j,b as F,L as z}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-2c716353.js";const L=e({__name:"MobileForm",setup(e){const L=b.Item,{t:S}=v(),{notification:B,createErrorModal:E}=_(),{prefixCls:I}=s("login"),M=a(),{handleBackLogin:T,getLoginState:w}=k(),{getFormRules:$}=C(),q=l(),D=l(!1),P=o({mobile:"18888888888",sms:"000000"}),{validForm:R}=F(q),U=t((()=>m(w)===z.MOBILE));function N(){return e=this,s=null,a=function*(){const e=yield R();if(e)try{D.value=!0;const s=yield M.login(x({grantType:"2",mobile:e.mobile,code:e.sms,mode:"none"}));s&&B.success({message:S("sys.login.loginSuccessTitle"),description:`${S("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3})}catch(s){E({title:S("sys.api.errorTip"),content:s.message||S("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${I}`)||document.body})}finally{D.value=!1}},new Promise(((l,o)=>{var t=e=>{try{i(a.next(e))}catch(s){o(s)}},n=e=>{try{i(a.throw(e))}catch(s){o(s)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(t,n);i((a=a.apply(e,s)).next())}));var e,s,a}return(e,s)=>U.value?(n(),i(f,{key:0},[r(j,{class:"enter-x"}),r(m(b),{class:"p-4 enter-x",model:P,rules:m($),ref_key:"formRef",ref:q},{default:c((()=>[r(m(L),{name:"mobile",class:"enter-x"},{default:c((()=>[r(m(u),{maxlength:11,size:"large",value:P.mobile,"onUpdate:value":s[0]||(s[0]=e=>P.mobile=e),placeholder:m(S)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])])),_:1}),r(m(L),{name:"sms",class:"enter-x"},{default:c((()=>[r(m(h),{size:"large",class:"fix-auto-fill",value:P.sms,"onUpdate:value":s[1]||(s[1]=e=>P.sms=e),placeholder:m(S)("sys.login.smsCode")},null,8,["value","placeholder"])])),_:1}),r(m(L),{class:"enter-x"},{default:c((()=>[r(m(d),{type:"primary",size:"large",block:"",onClick:N,loading:D.value},{default:c((()=>[g(p(m(S)("sys.login.loginButton")),1)])),_:1},8,["loading"]),r(m(d),{size:"large",block:"",class:"mt-4",onClick:m(T)},{default:c((()=>[g(p(m(S)("sys.login.backSignIn")),1)])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])],64)):y("",!0)}});export{L as _};
