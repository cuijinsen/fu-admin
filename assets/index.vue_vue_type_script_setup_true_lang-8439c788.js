var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,s,o)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o,i=(e,t,s)=>new Promise(((o,r)=>{var n=e=>{try{i(s.next(e))}catch(t){r(t)}},a=e=>{try{i(s.throw(e))}catch(t){r(t)}},i=e=>e.done?o(e.value):Promise.resolve(e.value).then(n,a);i((s=s.apply(e,t)).next())}));import{a as l,s as u,bs as d,K as c,at as y,aF as p,bT as m,o as f,f as b,m as v,y as k,w as _,i as g,z as h,F as x,h as I,t as j,f6 as C,j as M,b9 as w,E as O}from"./index-d32d699d.js";import{T}from"./index-280a19eb.js";import{u as S,B as P}from"./useTable-ba3fb261.js";import{T as E}from"./useForm-39f6e704.js";import{u as F}from"./index-b361c612.js";import{c as R,s as B,_ as U}from"./FormModal.vue_vue_type_script_setup_true_lang-a8df8b2a.js";import{f as K,r as z}from"./sysMenuApi-b7b39e4b.js";import{s as A}from"./index-2e5c6a76.js";const D=l({__name:"index",props:{nodeId:{type:String}},emits:["refresh-tree"],setup(e,{expose:l,emit:D}){const W=e,q=u([]),G=u([]),H=u([]),J=u([]),L=u([]),N=u([]);d((()=>i(this,null,(function*(){q.value=yield A({dictCode:"sys_menu_type"}),G.value=yield A({dictCode:"sys_keepalive"}),H.value=yield A({dictCode:"sys_link_external"}),J.value=yield A({dictCode:"sys_visible"}),L.value=yield A({dictCode:"sys_frame"}),N.value=yield A({dictCode:"sys_status"})}))));const{createMessage:Q}=O(),[V,{openModal:X}]=F(),[Y,{reload:Z}]=S({title:"菜单列表",api:K,rowKey:"id",columns:R,formConfig:{baseColProps:{sm:24,lg:6},labelWidth:90,schemas:B,autoSubmitOnEnter:!0,resetButtonOptions:{preIcon:"ant-design:delete-outlined"},submitButtonOptions:{preIcon:"ant-design:search-outlined"}},showIndexColumn:!1,useSearchForm:!0,showTableSetting:!0,bordered:!0,actionColumn:{auth:["system:sysMenu:updateSysMenu","system:sysMenu:removeSysMenu"],width:80,title:"操作",dataIndex:"action"},beforeFetch:function(e){return i=((e,t)=>{for(var s in t||(t={}))r.call(t,s)&&a(e,s,t[s]);if(o)for(var s of o(t))n.call(t,s)&&a(e,s,t[s]);return e})({},e),l={parentId:W.nodeId?W.nodeId:"0"},t(i,s(l));var i,l}});function $(){const e={parentId:W.nodeId};X(!0,{record:e,isUpdate:!1})}function ee(e){X(!0,{record:e,isUpdate:!0})}function te(e){return i(this,null,(function*(){yield z({ids:e.id}),Q.success("删除成功！"),D("refresh-tree","0"===e.parentId?void 0:e.parentId)}))}function se({isUpdate:e,values:t}){D("refresh-tree",t.parentId)}return c((()=>W.nodeId),(()=>{y((()=>{Z()}))})),l({refresh:function(){Z()}}),(e,t)=>{const s=p("a-button"),o=m("auth");return f(),b("div",null,[v(I(P),{onRegister:I(Y)},{toolbar:k((()=>[_((f(),g(s,{type:"primary",onClick:$,preIcon:"ant-design:plus-outlined"},{default:k((()=>[h("新增")])),_:1})),[[o,["system:sysMenu:addSysMenu"]]])])),bodyCell:k((({column:e,record:t})=>["menuType"===e.key?(f(),b(x,{key:0},["dir"===t.menuType?(f(),g(I(T),{key:0,color:"warning"},{default:k((()=>[h(j(I(C)(q.value,t.menuType)),1)])),_:2},1024)):M("",!0),"menu"===t.menuType?(f(),g(I(T),{key:1,color:"processing"},{default:k((()=>[h(j(I(C)(q.value,t.menuType)),1)])),_:2},1024)):M("",!0),"button"===t.menuType?(f(),g(I(T),{key:2,color:"default"},{default:k((()=>[h(j(I(C)(q.value,t.menuType)),1)])),_:2},1024)):M("",!0)],64)):M("",!0),"icon"===e.key?(f(),g(I(w),{key:1,icon:t.icon},null,8,["icon"])):M("",!0),"keepalive"===e.key?(f(),b(x,{key:2},[t.keepalive?(f(),g(I(T),{key:0,color:"0"===t.keepalive?"processing":"error"},{default:k((()=>[h(j(I(C)(G.value,t.keepalive)),1)])),_:2},1032,["color"])):M("",!0)],64)):M("",!0),"linkExternal"===e.key?(f(),b(x,{key:3},[t.linkExternal?(f(),g(I(T),{key:0,color:"0"===t.linkExternal?"processing":"error"},{default:k((()=>[h(j(I(C)(H.value,t.linkExternal)),1)])),_:2},1032,["color"])):M("",!0)],64)):M("",!0),"visible"===e.key?(f(),b(x,{key:4},[t.visible?(f(),g(I(T),{key:0,color:"0"===t.visible?"processing":"error"},{default:k((()=>[h(j(I(C)(J.value,t.visible)),1)])),_:2},1032,["color"])):M("",!0)],64)):M("",!0),"frame"===e.key?(f(),b(x,{key:5},[t.frame?(f(),g(I(T),{key:0,color:"0"===t.frame?"processing":"error"},{default:k((()=>[h(j(I(C)(L.value,t.frame)),1)])),_:2},1032,["color"])):M("",!0)],64)):M("",!0),"status"===e.key?(f(),b(x,{key:6},[t.status?(f(),g(I(T),{key:0,color:"0"===t.status?"processing":"error"},{default:k((()=>[h(j(I(C)(N.value,t.status)),1)])),_:2},1032,["color"])):M("",!0)],64)):M("",!0),"action"===e.key?(f(),g(I(E),{key:7,actions:[{auth:["system:sysMenu:updateSysMenu"],icon:"clarity:note-edit-line",tooltip:"编辑",onClick:ee.bind(null,t)},{auth:["system:sysMenu:removeSysMenu"],icon:"ant-design:delete-outlined",tooltip:"删除",color:"error",popConfirm:{title:"是否确认删除",confirm:te.bind(null,t)}}]},null,8,["actions"])):M("",!0)])),_:1},8,["onRegister"]),v(U,{onRegister:I(V),onSuccess:se},null,8,["onRegister"])])}}});export{D as _};
