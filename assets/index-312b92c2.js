var e=(e,t,l)=>new Promise(((a,i)=>{var d=e=>{try{r(l.next(e))}catch(t){i(t)}},o=e=>{try{r(l.throw(e))}catch(t){i(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(d,o);r((l=l.apply(e,t)).next())}));import{a as t,s as l,bs as a,v as i,aF as d,o,f as r,m as n,y as u,F as s,aI as m,i as c,aG as p,f3 as f,z as v,f4 as y}from"./index-d32d699d.js";import{s as h}from"./sysAreaApi-e41d1f2f.js";import{d as b,k as g,u as V,l as _,m as C}from"./sysDeptApi-2c1e26d4.js";const k=[{type:"checkbox"},{type:"seq",minWidth:60,title:"序号"},{title:"id",field:"id",minWidth:80,visible:!1},{title:"parentId",field:"parentId",minWidth:80,visible:!1},{title:"品牌id",field:"deptId",minWidth:80,visible:!1},{title:"品牌名",field:"brand",minWidth:80,treeNode:!0},{title:"省份",field:"province",minWidth:80},{title:"城市",field:"city",minWidth:80},{title:"地区",field:"district",minWidth:80},{title:"优先级",field:"priority",minWidth:80,editRender:{},slots:{edit:"priority_edit"}},{title:"创建时间",field:"createdAt",minWidth:120},{title:"修改时间",field:"updatedAt",minWidth:120},{title:"操作",width:300,slots:{default:"operate"}}],w=[{field:"id",title:"品牌名",itemRender:{},editRender:{},slots:{default:"name_item"}},{field:"province",title:"省份",itemRender:{},editRender:{},slots:{default:"province_item"}},{field:"city",title:"城市",itemRender:{},editRender:{},slots:{default:"city_item"}},{field:"district",title:"区域",itemRender:{},editRender:{},slots:{default:"district_item"}},{itemRender:{},slots:{default:"submit_item"}},{itemRender:{},slots:{default:"reset_item"}}],U=t({__name:"index",setup(t){const U=l(),x=l([]),R=l([]),I=l([]),W=l([]);a((()=>e(this,null,(function*(){x.value=yield h({parentCode:"0"}),W.value=yield b({})}))));const E=i({showEdit:!1,submitLoading:!1,formData:{deptId:"",brand:"",province:"",city:"",district:"",priority:0}}),N=i({border:!0,keepSource:!0,height:800,columnConfig:{resizable:!0},rowConfig:{keyField:"id"},treeConfig:{transform:!0,rowField:"id",parentField:"parentId"},checkboxConfig:{reserve:!0},showOverflow:!0,showHeaderOverflow:!0,formConfig:{titleWidth:150,titleAlign:"right",items:w},align:"center",toolbarConfig:{tools:[{name:"新增",code:"MyInsert"},{name:"保存修改",code:"MyUpdate"}],refresh:!0,zoom:!0,custom:!0},pagerConfig:{pageSize:10,pageSizes:[5,10,20,50,100,200,500,1e3]},sortConfig:{trigger:"cell",remote:!0,defaultSort:{field:"createAt",order:"desc"}},filterConfig:{remote:!0},proxyConfig:{seq:!0,sort:!0,filter:!0,form:!0,props:{result:"records",total:"total"},ajax:{query:({page:e,sorts:t,filters:l,form:a})=>{const i=Object.assign({current:e.currentPage,size:e.pageSize},a),d=null==t?void 0:t[0];return d&&(i.field=d.field,i.order=d.order),(null==l?void 0:l.length)>0&&l.forEach((({field:e,values:t})=>{i[e]=t.join(",")})),g(i)}}},columns:k,editConfig:{trigger:"click",mode:"row",showStatus:!0}}),z=e=>{const t=U.value;return!!t&&t.isEditByRow(e)},A={toolbarToolClick({code:e}){const t=U.value;if(t)switch(e){case"MyInsert":E.formData={deptId:"",brand:"",province:"",city:"",district:"",priority:0},E.showEdit=!0;break;case"MyUpdate":{const e=t.getUpdateRecords();e.length>0?y.modal.confirm("您确定要保存修改的数据?").then((t=>{"confirm"===t&&(N.loading=!0,V(e).then((()=>{N.loading=!1})))})):y.modal.alert("没有修改的数据");break}}}},S=()=>{const e=U.value;e&&e.clearEdit()},j=t=>e(this,null,(function*(){const e=yield y.modal.confirm("您确定要删除该数据?"),l=U.value;l&&"confirm"===e&&(yield _({ids:t.id}),yield l.remove(t))}));function D(t){return e(this,null,(function*(){R.value=yield h({parentCode:t.value})}))}const F=()=>e(this,null,(function*(){E.submitLoading=!0;const e=U.value;e&&(E.showEdit=!1,C(E.formData).then((()=>{y.modal.message({content:"新增成功",status:"success"}),e.commitProxy("reload"),E.submitLoading=!1}),(e=>{E.submitLoading=!1,y.modal.message({content:"新增失败,错误"+e,status:"error"})})))}));function L(t){return e(this,null,(function*(){I.value=yield h({parentCode:t.value})}))}return(e,t)=>{const l=d("vxe-option"),a=d("vxe-select"),i=d("vxe-input"),y=d("vxe-button"),h=d("vxe-grid"),b=d("vxe-form-item"),g=d("vxe-form"),V=d("vxe-modal");return o(),r("div",null,[n(h,p({ref_key:"xGrid",ref:U},N,f(A)),{name_item:u((({data:e})=>[n(a,{modelValue:e.id,"onUpdate:modelValue":t=>e.id=t,clearable:"",placeholder:"请选择品牌名"},{default:u((()=>[(o(!0),r(s,null,m(W.value,((e,t)=>(o(),c(l,{key:t,label:e.deptName,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),province_item:u((({data:e})=>[n(a,{modelValue:e.province,"onUpdate:modelValue":t=>e.province=t,clearable:"",placeholder:"请选择省份",onChange:D},{default:u((()=>[(o(!0),r(s,null,m(x.value,((e,t)=>(o(),c(l,{key:t,label:e.areaName,value:e.areaCode},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),city_item:u((({data:e})=>[n(a,{modelValue:e.city,"onUpdate:modelValue":t=>e.city=t,clearable:"",placeholder:"请选择城市",onChange:L},{default:u((()=>[(o(!0),r(s,null,m(R.value,((e,t)=>(o(),c(l,{key:t,label:e.areaName,value:e.areaCode},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),district_item:u((({data:e})=>[n(a,{modelValue:e.district,"onUpdate:modelValue":t=>e.district=t,clearable:"",placeholder:"请选择区域"},{default:u((()=>[(o(!0),r(s,null,m(I.value,((e,t)=>(o(),c(l,{key:t,label:e.areaName,value:e.areaCode},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),priority_edit:u((({row:e})=>[n(i,{modelValue:e.priority,"onUpdate:modelValue":t=>e.priority=t,type:"text"},null,8,["modelValue","onUpdate:modelValue"])])),operate:u((({row:e})=>[z(e)?(o(),c(y,{key:0,content:"取消",onClick:S})):(o(),c(y,{key:1,content:"编辑",onClick:t=>(e=>{const t=U.value;t&&t.setEditRow(e)})(e)},null,8,["onClick"])),n(y,{content:"删除",status:"danger",onClick:t=>j(e)},null,8,["onClick"])])),submit_item:u((()=>[n(y,{content:"查询",status:"primary",type:"submit"})])),reset_item:u((()=>[n(y,{content:"重置",type:"reset"})])),_:1},16),n(V,{modelValue:E.showEdit,"onUpdate:modelValue":t[0]||(t[0]=e=>E.showEdit=e),loading:E.submitLoading,"destroy-on-close":"","min-height":"300","min-width":"600",resize:"",title:" 新增",width:"800"},{default:u((()=>[n(g,{data:E.formData,"title-align":"right","title-width":"100",onSubmit:F},{default:u((()=>[n(b,{"item-render":{},span:12,field:"deptId",title:"品牌名"},{default:u((({data:e})=>[n(a,{modelValue:e.deptId,"onUpdate:modelValue":t=>e.deptId=t,clearable:"",placeholder:"请选择品牌名"},{default:u((()=>[(o(!0),r(s,null,m(W.value,((e,t)=>(o(),c(l,{key:t,label:e.deptName,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),n(b,{"item-render":{},span:12,field:"province",title:"省"},{default:u((({data:e})=>[n(a,{modelValue:e.province,"onUpdate:modelValue":t=>e.province=t,clearable:"",placeholder:"请选择省份",onChange:D},{default:u((()=>[(o(!0),r(s,null,m(x.value,((e,t)=>(o(),c(l,{key:t,label:e.areaName,value:e.areaCode},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),n(b,{"item-render":{},span:12,field:"city",title:"市"},{default:u((({data:e})=>[n(a,{modelValue:e.city,"onUpdate:modelValue":t=>e.city=t,clearable:"",placeholder:"请选择城市",onChange:L},{default:u((()=>[(o(!0),r(s,null,m(R.value,((e,t)=>(o(),c(l,{key:t,label:e.areaName,value:e.areaCode},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),n(b,{"item-render":{},span:12,field:"district",title:"区域"},{default:u((({data:e})=>[n(a,{modelValue:e.district,"onUpdate:modelValue":t=>e.district=t,clearable:"",placeholder:"请选择区域"},{default:u((()=>[(o(!0),r(s,null,m(I.value,((e,t)=>(o(),c(l,{key:t,label:e.areaName,value:e.areaCode},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),n(b,{"item-render":{},span:12,field:"priority",title:"优先级"},{default:u((({data:e})=>[n(i,{modelValue:e.priority,"onUpdate:modelValue":t=>e.priority=t,placeholder:"请输入优先级",type:"number"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),n(b,{span:24,align:"center","title-align":"left"},{default:u((()=>[n(y,{type:"submit"},{default:u((()=>[v("提交")])),_:1}),n(y,{type:"reset"},{default:u((()=>[v("重置")])),_:1})])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue","loading"])])}}});export{U as default};
