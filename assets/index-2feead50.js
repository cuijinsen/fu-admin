var e=(e,t,o)=>new Promise(((i,s)=>{var r=e=>{try{a(o.next(e))}catch(t){s(t)}},n=e=>{try{a(o.throw(e))}catch(t){s(t)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,n);a((o=o.apply(e,t)).next())}));import{cR as t,a as o,s as i,bs as s,o as r,f as n,m as a,y as d,i as m,h as l,z as p,t as c,f6 as u,j as f,E as j}from"./index-d32d699d.js";import{T as x}from"./index-280a19eb.js";import{u as b,B as h}from"./useTable-ba3fb261.js";import{T as g}from"./useForm-39f6e704.js";import{s as y}from"./index-2e5c6a76.js";import"./index-428eee78.js";import"./eagerComputed-b16e681c.js";import"./css-49036a2d.js";import"./fromPairs-c5e23fef.js";import"./iconUtil-b885d1ac.js";import"./index-22735145.js";import"./index-e84e313c.js";import"./createForOfIteratorHelper-19a6e609.js";import"./index-da1a1de3.js";import"./index-64da741e.js";import"./scrollTo-7d931d9a.js";import"./index-ceb1e509.js";import"./index-e9d5eda1.js";import"./index-2887dac0.js";import"./useSize-e28be3fa.js";import"./useWindowSizeFn-6acabc85.js";import"./useContentViewHeight-295eef1a.js";import"./ArrowLeftOutlined-f42bc447.js";import"./index-9c0d62a6.js";import"./transButton-c20bc4d9.js";import"./index-706c8391.js";import"./index-bf8f159c.js";import"./index-ee500efb.js";import"./get-8e454bdf.js";import"./index-b361c612.js";import"./FullscreenOutlined-091fbcf5.js";import"./index-b4d18824.js";import"./sortable.esm-871e648d.js";import"./RedoOutlined-481f10d7.js";import"./index-a72363e5.js";import"./index-f7867750.js";import"./index-6cd0fcd2.js";import"./index-06c8a48f.js";import"./index-cd646f4b.js";import"./_baseIteratee-b178d67d.js";import"./index-fe305bf5.js";import"./index-476a8598.js";import"./useRefs-b0536d84.js";import"./download-29600a9b.js";import"./index-406c2228.js";import"./index-8e2feec8.js";import"./uniqBy-19fec0f2.js";const w=[{title:"会话ID",dataIndex:"token",width:280},{title:"用户平台",dataIndex:"userPlatform",width:120},{title:"用户名",dataIndex:"username",width:150},{title:"登录IP地址",dataIndex:"ipAddress",width:120},{title:"登录地点",dataIndex:"loginLocation",width:150},{title:"浏览器类型",dataIndex:"browser",width:150},{title:"操作系统",dataIndex:"os"},{title:"登录时间",dataIndex:"loginTime",width:160}],I=[{field:"userPlatform",label:"用户平台",component:"ApiSelect",componentProps:{placeholder:"请选择用户平台",api:y,params:{dictCode:"sys_user_platform"}}},{field:"username",label:"用户名",component:"Input",componentProps:{placeholder:"请输入用户名"}}];function P(e){return t.get({url:"/system/monitor/online/selectSysUserOnlineWithPage",params:e})}const C=o({__name:"index",setup(o){const C=i([]);s((()=>e(this,null,(function*(){C.value=yield y({dictCode:"sys_user_platform"})}))));const{createMessage:v}=j(),[_,{reload:k}]=b({title:"在线用户列表 ",api:P,rowKey:"token",columns:w,formConfig:{baseColProps:{sm:24,lg:6},labelWidth:90,schemas:I,autoSubmitOnEnter:!0,resetButtonOptions:{preIcon:"ant-design:delete-outlined"},submitButtonOptions:{preIcon:"ant-design:search-outlined"}},showIndexColumn:!1,useSearchForm:!0,showTableSetting:!0,bordered:!0,actionColumn:{auth:["monitor:onlineUser:forceLogout"],width:80,title:"操作",dataIndex:"action"}});function O(o){return e(this,null,(function*(){var e;yield(e={userPlatform:o.userPlatform,token:o.token},t.post({url:"/system/monitor/online/forceLogout",params:e},{joinParamsToUrl:!0})),v.success("强退成功！"),yield k()}))}return(e,t)=>(r(),n("div",null,[a(l(h),{onRegister:l(_)},{bodyCell:d((({column:e,record:t})=>["userPlatform"===e.key?(r(),m(l(x),{key:0,color:"WEB"===t.userPlatform?"processing":"default"},{default:d((()=>[p(c(l(u)(C.value,t.userPlatform)),1)])),_:2},1032,["color"])):f("",!0),"action"===e.key?(r(),m(l(g),{key:1,actions:[{auth:["monitor:onlineUser:forceLogout"],icon:"ant-design:delete-outlined",tooltip:"强制退出",color:"error",popConfirm:{title:"是否确认强制退出",confirm:O.bind(null,t)}}]},null,8,["actions"])):f("",!0)])),_:1},8,["onRegister"])]))}});export{C as default};
