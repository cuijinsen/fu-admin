var _=(b,l,s)=>new Promise((d,u)=>{var g=o=>{try{r(s.next(o))}catch(i){u(i)}},f=o=>{try{r(s.throw(o))}catch(i){u(i)}},r=o=>o.done?d(o.value):Promise.resolve(o.value).then(g,f);r((s=s.apply(b,l)).next())});import{a as B,c as L,b as E,s as z,v as k,w as M,f as R,i as e,o as D,h as N,n as t,z as n,I as T,C as v,B as C,t as S,F as V,k as $,E as U,G as q}from"./index.01016e1b.js";/* empty css              *//* empty css               */import{C as G}from"./index.499a6f59.js";import{u as O,a as j,L as A,_ as H,b as J}from"./LoginFormTitle.15f995ca.js";import{F}from"./Form.45f609aa.js";import"./Col.d5380690.js";import"./useFlexGapSupport.0520fe90.js";import"./_baseIteratee.c73c9502.js";import"./get.1a35d26d.js";import"./useSize.368ff12a.js";const ne=B({__name:"MobileForm",setup(b){const l=F.Item,{t:s}=L(),{notification:d,createErrorModal:u}=q(),{prefixCls:g}=E("login"),f=z(),{handleBackLogin:r,getLoginState:o}=O(),{getFormRules:i}=j(),x=k(),p=k(!1),m=M({mobile:"18888888888",sms:"000000"}),{validForm:I}=J(x),h=R(()=>e(o)===A.MOBILE);function w(){return _(this,null,function*(){const c=yield I();if(!!c)try{p.value=!0;const a=yield f.login(U({grantType:"2",mobile:c.mobile,code:c.sms,mode:"none"}));a&&d.success({message:s("sys.login.loginSuccessTitle"),description:`${s("sys.login.loginSuccessDesc")}: ${a.realName}`,duration:3})}catch(a){u({title:s("sys.api.errorTip"),content:a.message||s("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${g}`)||document.body})}finally{p.value=!1}})}return(c,a)=>e(h)?(D(),N(V,{key:0},[t(H,{class:"enter-x"}),t(e(F),{class:"p-4 enter-x",model:m,rules:e(i),ref_key:"formRef",ref:x},{default:n(()=>[t(e(l),{name:"mobile",class:"enter-x"},{default:n(()=>[t(e(T),{maxlength:11,size:"large",value:m.mobile,"onUpdate:value":a[0]||(a[0]=y=>m.mobile=y),placeholder:e(s)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),t(e(l),{name:"sms",class:"enter-x"},{default:n(()=>[t(e(G),{size:"large",class:"fix-auto-fill",value:m.sms,"onUpdate:value":a[1]||(a[1]=y=>m.sms=y),placeholder:e(s)("sys.login.smsCode")},null,8,["value","placeholder"])]),_:1}),t(e(l),{class:"enter-x"},{default:n(()=>[t(e(v),{type:"primary",size:"large",block:"",onClick:w,loading:p.value},{default:n(()=>[C(S(e(s)("sys.login.loginButton")),1)]),_:1},8,["loading"]),t(e(v),{size:"large",block:"",class:"mt-4",onClick:e(r)},{default:n(()=>[C(S(e(s)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])],64)):$("",!0)}});export{ne as default};
