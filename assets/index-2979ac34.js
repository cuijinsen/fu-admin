var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,s=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&r(e,a,t[a]);if(l)for(var a of l(t))o.call(t,a)&&r(e,a,t[a]);return e},d=(e,l)=>t(e,a(l)),n=(e,t,a)=>new Promise(((l,i)=>{var o=e=>{try{s(a.next(e))}catch(t){i(t)}},r=e=>{try{s(a.throw(e))}catch(t){i(t)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,r);s((a=a.apply(e,t)).next())}));import{l as u}from"./zh_CN-7c7f3bd9.js";import{h as m}from"./moment-4b88eb1c.js";import{D as f}from"./index-ee500efb.js";import{cv as c,a as p,dt as v,bV as h,ao as g,v as y,s as b,bs as _,J as x,r as I,f4 as T,at as w,aF as C,bT as j,o as U,f as Y,m as D,y as H,h as k,b4 as S,w as R,i as M,z as P,I as O,dn as N,l as W,t as z,j as V,aG as E,E as q}from"./index-d32d699d.js";import{T as A}from"./index-280a19eb.js";import{T as F}from"./index-fe305bf5.js";import{C as L}from"./index-e84e313c.js";import{e as B,f as G,d as J}from"./userApi-36d22843.js";import{s as X}from"./index-2e5c6a76.js";import{s as $}from"./sysAreaApi-e41d1f2f.js";import{s as K,a as Q}from"./sysDeptApi-2c1e26d4.js";import{a as Z}from"./index-35313998.js";import{_ as ee,R as te}from"./DetailModal.vue_vue_type_script_setup_true_lang-e53fb8be.js";import"./createForOfIteratorHelper-19a6e609.js";import"./iconUtil-b885d1ac.js";import"./eagerComputed-b16e681c.js";import"./index-41a26491.js";import"./ArrowLeftOutlined-f42bc447.js";import"./index-d5b1635c.js";import"./index-42f6d054.js";import"./index-80ea7d72.js";import"./useRefs-b0536d84.js";import"./index-8e2feec8.js";import"./index-cd646f4b.js";import"./index-b0cc5f6c.js";import"./index-0a65f22b.js";const ae=[{type:"seq",minWidth:60,title:"序号",fixed:"left"},{title:"所属地市",field:"city",slots:{default:"city_default"},minWidth:150},{title:"所属区县",field:"district",slots:{default:"district_default"},minWidth:150},{title:"领取人姓名",field:"getName",fixed:"left",minWidth:150},{title:"领取人手机号",field:"getPhone",fixed:"left",minWidth:150},{title:"核销时间",field:"verifyTime",minWidth:150,sortable:!0},{title:"创建时间",field:"createTime",minWidth:150,sortable:!0},{title:"状态",field:"userStatus",minWidth:100,filters:[{label:"已选择",value:"1"},{label:"已领取",value:"2"},{label:"部分核销",value:"3"},{label:"全部核销",value:"4"},{label:"已关注",value:"5"},{label:"已验证",value:"6"},{label:"已授权",value:"7"}],slots:{default:"userStatus_default"},filterMultiple:!0},{title:"openId",field:"openId",minWidth:150},{title:"领取时间",field:"paymentTime",minWidth:150,sortable:!0},{title:"分娩时间",field:"childBirthDate",minWidth:150},{title:"差值",field:"diffTime",minWidth:150},{title:"分娩医院",field:"hospital",slots:{default:"hospital_default"},minWidth:150},{title:"领取入口",field:"entrance",filters:[{label:"出生证明",value:"cszm"},{label:"我需要",value:"need"},{label:"Banner",value:"banner"},{label:"二维码",value:"qrcode"}],slots:{default:"entrance_default"},filterMultiple:!0,minWidth:150},{title:"操作",field:"action",width:100,fixed:"right",slots:{default:"action_default"}}],le=[{field:"deptId",title:"店家",itemRender:{},slots:{default:"deptId_item"}},{field:"verifyStatus",title:"核销状态",itemRender:{},slots:{default:"verifyStatus_item"}},{field:"getName",title:"领取人姓名",itemRender:{},folding:!0,slots:{default:"getName_item"}},{field:"getPhone",title:"领取人手机号",itemRender:{},folding:!0,slots:{default:"getPhone_item"}},{field:"city",title:"城市",itemRender:{},slots:{default:"city_item"}},{field:"district",title:"区域",itemRender:{},slots:{default:"district_item"}},{field:"startTime",title:"领取时间",itemRender:{},slots:{default:"paymentTime_item"}},{field:"endTime",title:"领取时间",visible:!1},{field:"beginTime",title:"创建时间",itemRender:{},slots:{default:"createTime_item"}},{field:"lastTime",title:"创建时间",visible:!1},{itemRender:{},slots:{default:"submit_item"}},{itemRender:{},collapseNode:!0,slots:{default:"reset_item"}}];var ie={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,a=window.document;function l(e){var l=!1;try{!function(e){if(!t){(t=a.createElement("textarea")).id="$XECopy";var l=t.style;l.width="48px",l.height="24px",l.position="fixed",l.zIndex="0",l.left="-500px",l.top="-500px",a.body.appendChild(t)}t.value=null==e?"":""+e}(e),t.select(),t.setSelectionRange(0,t.value.length),l=a.execCommand("copy"),t.blur()}catch(i){}return l}function i(e){return l(e)}i.copy=l;var o=i;e.default=o}(ie);const oe=c(ie),re=W("span",null,"--",-1),se=W("span",null,"--",-1),de=p(d(s({},{name:"SelectByShop"}),{setup(e){let t=ae;const{hasPermission:a}=v(),l=h(g,{style:{fontSize:"24px"},spin:!0}),i=y({value8:!1,formData3:{patientName:"",patientIdCard:""},formRules3:{patientName:[{required:!0,message:"请输入名称"}],patientIdCard:[{required:!0,message:"请输入身份证号"}]}}),o=b(!1),r=b([]);r.value=[{label:"总公司",value:I().getUserInfo.deptId.toString()}];const[c,{openDrawer:p}]=Z(),ie=b([]),de=b(),ne=b([]),ue=b([]);_((()=>n(this,null,(function*(){ie.value=yield X({dictCode:"user_status"}),$({parentCode:"370000"}).then((e=>e.forEach((e=>{ue.value.push({label:e.areaName,value:e.areaCode})}))))})))),x((()=>{!function(){n(this,null,(function*(){"1406955981362733058"==I().getUserInfo.deptId?pe.value=yield K().then((e=>e.map((e=>({id:e.id,label:e.name,title:e.name,value:e.id,key:e.id,pId:e.parentId}))))):pe.value=yield Q({nodeId:I().getUserInfo.deptId,userId:I().getUserInfo.userId}).then((e=>e.map((e=>({id:e.id,label:e.name,title:e.name,value:e.id,key:e.id,pId:e.parentId})))))}))}()}));a(te.ROOT)||(t=ae.filter((e=>"getName"===e.field||"getPhone"===e.field||"verifyTime"===e.field||"paymentTime"===e.field||"action"===e.field||"userStatus"===e.field)));const me=y({border:!0,height:750,columnConfig:{isCurrent:!0,resizable:!0},checkboxConfig:{reserve:!0},showOverflow:!0,showHeaderOverflow:!0,rowConfig:{keyField:"id",isCurrent:!0,isHover:!0},formConfig:{titleWidth:100,titleAlign:"right",items:le},exportConfig:{types:["xlsx"],modes:["all"],remote:!0,exportMethod({options:e}){var t;const a=de.value;if(a){const l=a.getProxyInfo(),i=l?l.form:null;i&&(i.startTime&&(i.startTime=i.startTime.format("YYYY-MM-DD HH:mm:ss")),i.endTime&&(i.endTime=i.endTime.format("YYYY-MM-DD HH:mm:ss")),i.beginTime&&(i.beginTime=i.beginTime.format("YYYY-MM-DD HH:mm:ss")),i.lastTime&&(i.lastTime=i.lastTime.format("YYYY-MM-DD HH:mm:ss")));const o=d(s({},i),{filename:e.filename,sheetName:e.sheetName,isHeader:e.isHeader,original:e.original,mode:e.mode,exportPermission:I().getRoleList,userId:null==(t=I().getUserInfo)?void 0:t.userId,pager:l?l.pager:null,ids:"selected"===e.mode?e.data.map((e=>e.id)):[],fields:e.columns.map((e=>({field:e.field,title:e.title})))});return B(o).then((e=>{const t=e.data,a=e.headers["content-disposition"].split(";")[1].split("=")[1],l=decodeURIComponent(escape(a));t&&(T.modal.message({content:"导出成功，开始下载",status:"success"}),T.saveFile({filename:l,type:"xlsx",content:t}))})).catch((()=>{T.modal.message({content:"导出失败！",status:"error"})}))}return Promise.resolve()}},printConfig:{},menuConfig:{body:{options:[[{code:"copy",name:"复制单元格内容",visible:!0,disabled:!1}]]}},align:"center",toolbarConfig:{refresh:!0,export:!0,print:!0,zoom:!0,custom:!0,slots:{buttons:"toolbar_buttons"}},pagerConfig:{pageSize:10,pageSizes:[5,10,20,50,100,200,500,1e3]},sortConfig:{trigger:"cell",remote:!0,defaultSort:{field:"createTime",order:"desc"}},filterConfig:{remote:!0},proxyConfig:{seq:!0,sort:!0,filter:!0,form:!0,props:{result:"records",total:"total"},ajax:{query:({page:e,sorts:t,filters:a,form:l})=>w((()=>{l.deptId=r.value.map((e=>e.value));const i=Object.assign({ownDeptId:I().getUserInfo.deptId,userId:I().getUserInfo.userId,current:e.currentPage,size:e.pageSize},l),o=null==t?void 0:t[0];return o&&(i.field=o.field,i.order=o.order),(null==a?void 0:a.length)>0&&a.forEach((({field:e,values:t})=>{i[e]=t.join(",")})),l&&(l.startTime&&(i.startTime=l.startTime.format("YYYY-MM-DD HH:mm:ss")),l.endTime&&(i.endTime=l.endTime.format("YYYY-MM-DD HH:mm:ss")),l.beginTime&&(i.beginTime=l.beginTime.format("YYYY-MM-DD HH:mm:ss")),l.lastTime&&(i.lastTime=l.lastTime.format("YYYY-MM-DD HH:mm:ss"))),G(i)}))}},columns:t});function fe(e){ne.value=[],$({parentCode:e}).then((e=>e.forEach((e=>{ne.value.push({label:e.areaName,value:e.areaCode})}))))}const{createMessage:ce}=q(),pe=b(),ve=()=>n(this,null,(function*(){yield T.modal.confirm("您确定要删除吗？"),yield J(i.formData3),i.value8=!1,ce.success("删除成功"),yield function(){return n(this,null,(function*(){const e=de.value;e&&(yield e.commitProxy("reload"))}))}()})),he=({data:e})=>{["lastTime","endTime"].forEach((t=>{e[t]=void 0})),r.value=[{label:"总公司",value:I().getUserInfo.deptId.toString()}]};const ge=e=>n(this,null,(function*(){const t=e.id;return e.dataRef.children||(e.dataRef.children=yield Q({nodeId:t,userId:I().getUserInfo.userId}).then((t=>t[0].children?t[0].children.map((e=>({id:e.id,label:e.name,title:e.name,key:e.id,value:e.id,pId:e.parentId}))):(e.dataRef.isLeaf=!0,[]))),e.dataRef.children.length>0?(e.dataRef.isLeaf=!1,pe.value=pe.value.concat(e.dataRef.children)):(e.dataRef.isLeaf=!0,pe.value=[...pe.value])),Promise.resolve()}));function ye({menu:e,row:t,column:a}){if(de.value&&"copy"===e.code)t&&a&&oe.copy(t[a.field])&&T.modal.message({content:"已复制到剪贴板！",status:"success"})}return(e,t)=>{const a=C("a-button"),s=C("vxe-grid"),d=C("vxe-input"),n=C("vxe-form-item"),v=C("vxe-button"),h=C("vxe-form"),g=C("vxe-modal"),y=j("auth");return U(),Y("div",null,[D(s,E({ref_key:"xGrid",ref:de},me,{onMenuClick:ye,onFormReset:he}),{loading:H((()=>[D(k(S),{indicator:k(l)},null,8,["indicator"])])),toolbar_buttons:H((()=>[R((U(),M(a,{class:"ml-auto",color:"warning",preIcon:"ant-design:delete-outlined",onClick:t[0]||(t[0]=e=>i.value8=!0)},{default:H((()=>[P("删除用户 ")])),_:1})),[[y,["system:user:deleteUser"]]])])),deptId_item:H((({})=>[D(k(F),{value:r.value,"onUpdate:value":t[1]||(t[1]=e=>r.value=e),"dropdown-style":{maxHeight:"400px",overflow:"auto"},"load-data":ge,"tree-data":pe.value,allowClear:"",placeholder:"请选择店家",showSearch:"",style:{width:"300px"},"tree-check-strictly":"","tree-checkable":"","tree-data-simple-mode":"","tree-node-filter-prop":"title"},null,8,["value","tree-data"])])),getName_item:H((({data:e})=>[D(k(O),{value:e.getName,"onUpdate:value":t=>e.getName=t,allowClear:"",placeholder:"请输入领取人名称"},null,8,["value","onUpdate:value"])])),getPhone_item:H((({data:e})=>[D(k(O),{value:e.getPhone,"onUpdate:value":t=>e.getPhone=t,allowClear:"",placeholder:"请输入领取人电话"},null,8,["value","onUpdate:value"])])),verifyStatus_item:H((({data:e})=>[D(k(L),{checked:e.verifyStatus,"onUpdate:checked":t=>e.verifyStatus=t},null,8,["checked","onUpdate:checked"])])),city_item:H((({data:e})=>[D(k(N),{value:e.city,"onUpdate:value":t=>e.city=t,options:ue.value,allowClear:"",placeholder:"请选择城市",style:{width:"200px"},onChange:fe},null,8,["value","onUpdate:value","options"])])),district_item:H((({data:e})=>[D(k(N),{value:e.district,"onUpdate:value":t=>e.district=t,options:ne.value,allowClear:"",placeholder:"请选择区域",style:{width:"200px"}},null,8,["value","onUpdate:value","options"])])),paymentTime_item:H((({data:e})=>[D(k(f),{value:e.startTime,"onUpdate:value":t=>e.startTime=t,locale:k(u),"show-time":{defaultValue:k(m)("00:00:00","HH:mm:ss")},placeholder:"开始时间"},null,8,["value","onUpdate:value","locale","show-time"]),re,D(k(f),{value:e.endTime,"onUpdate:value":t=>e.endTime=t,locale:k(u),"show-time":{defaultValue:k(m)("00:00:00","HH:mm:ss")},placeholder:"结束时间"},null,8,["value","onUpdate:value","locale","show-time"])])),createTime_item:H((({data:e})=>[D(k(f),{value:e.beginTime,"onUpdate:value":t=>e.beginTime=t,locale:k(u),"show-time":{defaultValue:k(m)("00:00:00","HH:mm:ss")},placeholder:"开始时间"},null,8,["value","onUpdate:value","locale","show-time"]),se,D(k(f),{value:e.lastTime,"onUpdate:value":t=>e.lastTime=t,locale:k(u),"show-time":{defaultValue:k(m)("00:00:00","HH:mm:ss")},placeholder:"结束时间"},null,8,["value","onUpdate:value","locale","show-time"])])),submit_item:H((()=>[D(a,{color:"primary",htmlType:"submit",preIcon:"ant-design:search-outlined"},{default:H((()=>[P("查询 ")])),_:1})])),reset_item:H((()=>[D(a,{htmlType:"reset",preIcon:"ant-design:redo-outlined"},{default:H((()=>[P("重置")])),_:1})])),city_default:H((({row:e})=>[W("span",null,z(e.shipping.receiverCity),1)])),district_default:H((({row:e})=>[W("span",null,z(e.shipping.receiverDistrict),1)])),userStatus_default:H((({row:e})=>["1"==e.userStatus?(U(),M(k(A),{key:0,color:"blue"},{default:H((()=>[P("已选择")])),_:1})):"2"===e.userStatus?(U(),M(k(A),{key:1,color:"green"},{default:H((()=>[P("已领取")])),_:1})):"3"===e.userStatus?(U(),M(k(A),{key:2,color:"orange"},{default:H((()=>[P("部分核销")])),_:1})):"4"===e.userStatus?(U(),M(k(A),{key:3,color:"red"},{default:H((()=>[P("已核销")])),_:1})):"0"===e.userStatus&&e.openId&&!e.shipping?(U(),M(k(A),{key:4,color:"yellow"},{default:H((()=>[P("已关注")])),_:1})):"0"!==e.userStatus||e.openId?"0"===e.userStatus&&e.shipping?(U(),M(k(A),{key:6,color:"cyan"},{default:H((()=>[P("已授权")])),_:1})):V("",!0):(U(),M(k(A),{key:5,color:"purple"},{default:H((()=>[P("已验证")])),_:1}))])),hospital_default:H((({row:e})=>[W("span",null,z(e.hospital.split("-")[1]),1)])),entrance_default:H((({row:e})=>["banner"==e.entrance?(U(),M(k(A),{key:0,color:"blue"},{default:H((()=>[P("Banner页")])),_:1})):"cszm"==e.entrance?(U(),M(k(A),{key:1,color:"green"},{default:H((()=>[P("出生证明")])),_:1})):"need"==e.entrance?(U(),M(k(A),{key:2,color:"red"},{default:H((()=>[P("我需要")])),_:1})):"qrcode"==e.entrance?(U(),M(k(A),{key:3,color:"yellow"},{default:H((()=>[P("二维码")])),_:1})):V("",!0)])),action_default:H((({row:e})=>[D(a,{type:"primary",onClick:t=>{return a=e,o.value=!0,Object.assign(a,{deptId:I().getUserInfo.deptId}),void w((()=>{p(!0,{record:a})}));var a}},{default:H((()=>[P("查看")])),_:2},1032,["onClick"])])),_:1},16),o.value?(U(),M(ee,{key:0,onClose:t[2]||(t[2]=e=>o.value=e),onRegister:k(c)},null,8,["onRegister"])):V("",!0),D(g,{modelValue:i.value8,"onUpdate:modelValue":t[5]||(t[5]=e=>i.value8=e),height:"400",remember:"",resize:"","show-zoom":"",title:"删除用户",width:"600"},{default:H((()=>[D(h,{data:i.formData3,rules:i.formRules3,"title-align":"right","title-width":"80",onSubmit:ve},{default:H((()=>[D(n,{field:"name",span:"12",title:"名称"},{default:H((()=>[D(d,{modelValue:i.formData3.patientName,"onUpdate:modelValue":t[3]||(t[3]=e=>i.formData3.patientName=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),D(n,{field:"nickname",span:"24",title:"身份证号"},{default:H((()=>[D(d,{modelValue:i.formData3.patientIdCard,"onUpdate:modelValue":t[4]||(t[4]=e=>i.formData3.patientIdCard=e),placeholder:"请输入身份证号"},null,8,["modelValue"])])),_:1}),D(n,{align:"center",span:"24"},{default:H((()=>[D(v,{status:"primary",type:"submit"},{default:H((()=>[P("提交")])),_:1}),D(v,{type:"reset"},{default:H((()=>[P("重置")])),_:1})])),_:1})])),_:1},8,["data","rules"])])),_:1},8,["modelValue"])])}}}));export{de as default};
